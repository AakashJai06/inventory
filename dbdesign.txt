Perfect ‚Äî below is the UPDATED schema design, aligned with everything you finalized:
‚úî Templates define rules, not fixed sections
‚úî Repeatable sections allowed
‚úî Section IDs are content-level, not template-level
‚úî Session IDs point to content sections
‚úî Template versioning is non-retroactive
‚úî One active draft per content
‚úî AssetId ‚Üí ContentId many-to-one
I‚Äôm giving this in the same table-style schema format you asked earlier (document / PPT ready).
üì¶ UPDATED DATABASE SCHEMA
Schema Name: CCMS_DB
Table: users
Description: Stores CMS users such as authors, reviewers, and administrators.
ID
COLUMN NAME
TYPE
CONSTRAINT
DESCRIPTION
1
user_id
INTEGER
PRIMARY KEY
Unique user identifier
2
username
VARCHAR(100)
UNIQUE, NOT NULL
Username
3
role
VARCHAR(50)
NOT NULL
User role
4
created_at
TIMESTAMP
NOT NULL
User creation timestamp
Table: templates
Description: Stores logical template definitions.
ID
COLUMN NAME
TYPE
CONSTRAINT
DESCRIPTION
1
template_id
INTEGER
PRIMARY KEY
Template identifier
2
template_name
VARCHAR(100)
UNIQUE, NOT NULL
Template name
3
created_at
TIMESTAMP
NOT NULL
Creation timestamp
Table: template_versions
Description: Stores versioned template schemas and hierarchy rules.
ID
COLUMN NAME
TYPE
CONSTRAINT
DESCRIPTION
1
template_version_id
INTEGER
PRIMARY KEY
Template version ID
2
template_id
INTEGER
FOREIGN KEY
References templates(template_id)
3
version_number
INTEGER
NOT NULL
Template version number
4
schema_json
JSONB
NOT NULL
Hierarchy rules & allowed section types
5
created_at
TIMESTAMP
NOT NULL
Version creation time
üìå Defines structure rules, repeatable section types, mandatory section types.
Table: contents
Description: Represents a logical documentation entity.
ID
COLUMN NAME
TYPE
CONSTRAINT
DESCRIPTION
1
content_id
INTEGER
PRIMARY KEY
Documentation identifier
2
template_id
INTEGER
FOREIGN KEY
References templates(template_id)
3
template_version_id
INTEGER
FOREIGN KEY
Template version bound to content
4
created_by
INTEGER
FOREIGN KEY
References users(user_id)
5
created_at
TIMESTAMP
NOT NULL
Creation time
Table: content_versions
Description: Stores draft and published versions of documentation.
ID
COLUMN NAME
TYPE
CONSTRAINT
DESCRIPTION
1
content_version_id
INTEGER
PRIMARY KEY
Version identifier
2
content_id
INTEGER
FOREIGN KEY
References contents(content_id)
3
version_number
INTEGER
NOT NULL
Version number
4
status
VARCHAR(20)
NOT NULL
DRAFT / REVIEW / PUBLISHED / DEPRECATED
5
content_json
JSONB
NOT NULL
Documentation content
6
created_by
INTEGER
FOREIGN KEY
References users(user_id)
7
created_at
TIMESTAMP
NOT NULL
Version creation time
üìå Only ONE active DRAFT per content enforced logically.
Table: content_sections
Description: Stores dynamically created content-level sections and subsections.
ID
COLUMN NAME
TYPE
CONSTRAINT
DESCRIPTION
1
section_id
VARCHAR(100)
PRIMARY KEY
Unique content-level section ID
2
content_id
INTEGER
FOREIGN KEY
References contents(content_id)
3
section_type
VARCHAR(50)
NOT NULL
Section type defined in template
4
parent_section_id
VARCHAR(100)
FOREIGN KEY
Self-reference for hierarchy
5
section_order
INTEGER
NOT NULL
Ordering within parent
6
created_at
TIMESTAMP
NOT NULL
Creation time
üìå Allows unlimited repeatable sections while enforcing hierarchy.
Table: asset_mappings
Description: Maps application contexts to documentation.
ID
COLUMN NAME
TYPE
CONSTRAINT
DESCRIPTION
1
asset_id
VARCHAR(100)
PRIMARY KEY
Application context identifier
2
content_id
INTEGER
FOREIGN KEY
References contents(content_id)
üìå Many AssetIds ‚Üí One ContentId supported.
Table: session_mappings
Description: Maps session identifiers to content sections for navigation.
ID
COLUMN NAME
TYPE
CONSTRAINT
DESCRIPTION
1
session_id
VARCHAR(100)
PRIMARY KEY
Session identifier
2
section_id
VARCHAR(100)
FOREIGN KEY
References content_sections(section_id)
3
content_id
INTEGER
FOREIGN KEY
References contents(content_id)
üìå SessionId ‚Üí Content Section ‚Üí Auto-scroll handled by UI.
Table: audit_logs
Description: Maintains audit trail of documentation lifecycle actions.
ID
COLUMN NAME
TYPE
CONSTRAINT
DESCRIPTION
1
audit_id
INTEGER
PRIMARY KEY
Audit record ID
2
content_id
INTEGER
FOREIGN KEY
References contents(content_id)
3
action
VARCHAR(50)
NOT NULL
Action performed
4
performed_by
INTEGER
FOREIGN KEY
References users(user_id)
5
performed_at
TIMESTAMP
NOT NULL
Action timestamp
üîë DESIGN GUARANTEES (Explain this confidently)
Requirement
How schema supports it
Unlimited sections
content_sections table
Template rules only
template_versions.schema_json
No retro break
content ‚Üí template_version
One active draft
enforced at service + DB index
Auto-scroll
session_mappings
Contextual help
asset_mappings
Version history
content_versions
üß† ONE-LINE SUMMARY (MEMORIZE)
‚ÄúTemplates define structural rules, content creates dynamic section instances, and session identifiers map to those sections for contextual navigation.‚Äù
If you want next, I can:
Provide DDL SQL for this exact schema
Draw a simple ER explanation
Optimize this for exam vs production
Reduce to MVP-only tables
Just tell me üëç